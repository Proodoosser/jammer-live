<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Jammer — 1 on 1</title>

<!-- inline small SVG favicon to avoid 404 -->
<link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16'%3E%3Crect width='100%25' height='100%25' fill='%230f0f0f'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' font-size='10' fill='%23ff5e00'%3EJ%3C/text%3E%3C/svg%3E">

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
<style>
  :root{ --bg:#0b0b0c; --muted:#9aa4ad; --accent:#ff5e00; }
  body{ margin:0; font-family:Inter,system-ui,Arial; background:var(--bg); color:#eee; }
  .wrap{ padding:12px; display:flex; gap:12px; height:100vh; box-sizing:border-box; }
  .left{ flex:1; display:flex; flex-direction:column; gap:12px; min-width:320px; }
  .right{ width:360px; display:flex; flex-direction:column; gap:12px; }
  .controls{ display:flex; gap:8px; align-items:center; }
  input, select, button{ padding:8px; border-radius:8px; background:#121212; border:1px solid #222; color:#eee; }
  button.btn-main{ background:var(--accent); color:#111; border:none; font-weight:700; }
  .videos{ display:flex; gap:8px; flex:1; align-items:stretch; }
  .video-box{ flex:1; background:#000; border-radius:10px; overflow:hidden; position:relative; border:1px solid rgba(255,255,255,0.03); min-height:240px; }
  video{ width:100%; height:100%; object-fit:cover; display:block; }
  .mini{ position:absolute; width:160px; height:100px; right:12px; bottom:12px; border-radius:8px; overflow:hidden; border:2px solid rgba(255,255,255,0.06); background:#000; cursor:grab; }
  .chat{ background:#0f1113; border-radius:10px; padding:12px; display:flex; flex-direction:column; height:calc(100vh - 48px - 24px); }
  .chat-area{ flex:1; overflow:auto; padding:6px; display:flex; flex-direction:column; gap:8px; }
  .chat-input{ display:flex; gap:8px; margin-top:8px; }
  .bubble { padding:8px 10px; border-radius:12px; max-width:80%; }
  .bubble.teacher{ background:#e8f0ff; color:#04203b; align-self:flex-end; border-bottom-right-radius:4px; }
  .bubble.student{ background:#e8ffe8; color:#083b08; align-self:flex-start; border-bottom-left-radius:4px; }
  .bubble.system{ background:transparent; color:var(--muted); font-style:italic; align-self:center; }
  .small{ font-size:12px; color:var(--muted); }
  .status{ margin-left:auto; color:var(--muted); }
  @media (max-width:900px){ .wrap{ flex-direction:column; } .right{ width:100%; height:40vh; } }
</style>
</head>
<body>
  <div class="wrap">
    <div class="left">
      <div class="controls">
        <input id="roomId" placeholder="Room id, например lesson123" value="lesson123" />
        <select id="roleSelect"><option value="teacher">Teacher</option><option value="student">Student</option></select>
        <button id="joinBtn" class="btn-main">Join / Start</button>
        <button id="leaveBtn" disabled>Leave</button>
        <div class="status small">Status: <span id="status">not connected</span></div>
        <div class="small" style="margin-left:8px">Socket: <span id="socketId">—</span></div>
      </div>

      <div class="videos">
        <div class="video-box">
          <video id="remoteVideo" autoplay playsinline></video>
          <div class="mini" id="miniWrap"><video id="localVideo" autoplay muted playsinline></video></div>
        </div>
      </div>

      <div style="display:flex; gap:8px;">
        <button id="swapBtn">Swap view</button>
        <button id="muteBtn">Mute</button>
        <button id="camBtn">Cam</button>
      </div>
    </div>

    <div class="right">
      <div class="chat">
        <div style="display:flex; align-items:center; justify-content:space-between;">
          <div><strong>Chat</strong> <span class="small">Jammer</span></div>
          <div class="small">Room: <span id="showRoom">—</span></div>
        </div>

        <div id="chatArea" class="chat-area">
          <!-- messages (bubbles) will be appended here -->
        </div>

        <div class="chat-input">
          <input id="chatInput" placeholder="Написать сообщение..." />
          <button id="sendChatBtn">Send</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // small UI helper: bubble-based addChat used by app.js
    (function(){
      const chatArea = document.getElementById('chatArea');
      window.addChat = function(user, text){
        const bubble = document.createElement('div');
        bubble.className = 'bubble ' + (user === 'system' ? 'system' : (user === 'teacher' ? 'teacher' : 'student'));
        bubble.innerHTML = `<div>${text}</div><div class="small" style="margin-top:6px">${new Date().toLocaleTimeString()} • ${user}</div>`;
        if(user === 'teacher') bubble.style.alignSelf = 'flex-end';
        else if(user === 'student') bubble.style.alignSelf = 'flex-start';
        else bubble.style.alignSelf = 'center';
        chatArea.appendChild(bubble);
        chatArea.scrollTop = chatArea.scrollHeight;
      };
    })();
  </script>

  <script src="/socket.io/socket.io.js"></script>
  <script src="app.js"></script>
</body>
</html>
